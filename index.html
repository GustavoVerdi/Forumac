<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="custom.css">
    <title>Fórum</title>
</head>
<body>
    <header>
        <!-- NAVBAR -->
        <div class="navbarmenu" style="width: 100%; height: 75px;">
            <div class="logo">
                <a href="#"><img src="./img/logo.png" style="width: 5%; left: 15px; position: absolute; margin: 3.6px;"></a>
            </div>
            <ul colspan="3" class="ulcabecalho">
                <li><a href="index.html" class="linavbar">Home</a></li>
                <li><a href="Diss.html" class="linavbar">Discussões</a></li>
                <li><a href="discord.html" class="linavbar">Discord</a></li>
                <li><a href="mods.html" class="linavbar">Mods</a></li>
                <li><a href="login.html" class="linavbar" style="background-color: black;">Login</a></li>
            </ul>
        </div>
    </header>

    <div id="templateindex">
        <img id="template" src="./img/template1.png" alt="Template Image">
    </div>

    <div id="containercenter">
        <h1 style="display: inline-block; text-align: center; font-size: 22px;">Tópicos</h1>
        <nav class="nav">
        <div class="topic">
            <h3>Título</h3>
            <p>Conteúdo da segunda dúvida.</p>
        </div>
    </nav>
        <?php
        include 'conexao.php';

        $tabela = 'topico';

        $termoBusca = isset($_GET['busca']) ? $_GET['busca'] : '';

        try {
            if (!empty($termoBusca)) {
                $stmt = $conexao->prepare("SELECT * FROM $tabela WHERE titulo ILIKE :termo");
                $stmt->bindValue(':termo', "%$termoBusca%", PDO::PARAM_STR);
            } else {
                $stmt = $conexao->query("SELECT * FROM $tabela");
            }

            $stmt->execute();
            $topicos = $stmt->fetchAll(PDO::FETCH_ASSOC);

            if (!empty($topicos)) {
                echo '<table>';
                echo '<tr class="topic"><th>Título</th><th>Categoria</th><th>Texto</th><th>Usuário</th></tr>';
                foreach ($topicos as $topico) {
                    echo '<tr class="topic">';
                    echo '<td><h3>' . $topico['titulo'] . '</h3></td>';
                    echo '<td><p>' . $topico['categoria'] . '</p></td>';
                    echo '<td><p>' . $topico['texto'] . '</p></td>';
                    echo '<td><p>' . $topico['usuario'] . '</p></td>';
                    echo '</tr>';
                }
                echo '</table>';
            } else {
                echo '<p>Nenhum resultado encontrado.</p>';
            }
        } catch (PDOException $e) {
            echo "Erro na consulta ao banco de dados: " . $e->getMessage();
        }
        ?>
    </div>
    <footer>
        <div class="rowfooter"></div>
        <p>teste</p>
    </footer>
</body>
</html>
